<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>동적 환경생물학 퀴즈</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h1, h2 { text-align: center; }
    .section { margin-bottom: 30px; }
    input[type="text"] { width: calc(100% - 12px); padding: 5px; font-size: 1em; margin-bottom: 10px; }
    button { padding: 8px 16px; font-size: 1em; margin-right: 10px; }
    ul { list-style: none; padding: 0; }
    li { margin-bottom: 5px; }
    .question { margin-bottom: 15px; }
    .correct { color: green; margin-left: 10px; }
    .wrong { color: red; margin-left: 10px; }
    #result { margin-top: 20px; font-size: 1.2em; text-align: center; }
  </style>
</head>
<body>
  <h1>동적 환경생물학 퀴즈 생성기</h1>

  <div id="editor" class="section">
    <h2>문제 추가</h2>
    <input type="text" id="new-question" placeholder="문제를 입력하세요" />
    <input type="text" id="new-answers" placeholder="정답들을 콤마로 구분하여 입력하세요" />
    <button onclick="addQuestion()">문제 추가</button>
    <h3>문제 목록</h3>
    <ul id="question-list"></ul>
    <button onclick="startQuiz()" id="start-btn" disabled>퀴즈 시작</button>
  </div>

  <div id="quiz" class="section" style="display:none;">
    <h2>퀴즈 풀기</h2>
    <form id="quiz-form" onsubmit="return false;"></form>
    <button onclick="checkAnswers()">제출</button>
    <button onclick="resetApp()">처음으로</button>
    <div id="result"></div>
  </div>

  <script>
    const questions = [];
    const normalize = s => s.replace(/\s+/g, '').toLowerCase();

    function addQuestion() {
      const qInput = document.getElementById('new-question');
      const aInput = document.getElementById('new-answers');
      const qText = qInput.value.trim();
      const answers = aInput.value.split(',').map(s => s.trim()).filter(s => s);
      if (!qText || answers.length === 0) {
        alert('문제와 하나 이상의 정답을 입력하세요.');
        return;
      }
      questions.push({ q: qText, a: answers });
      qInput.value = '';
      aInput.value = '';
      renderList();
    }

    function renderList() {
      const list = document.getElementById('question-list');
      list.innerHTML = '';
      questions.forEach((item, idx) => {
        const li = document.createElement('li');
        li.textContent = `${idx+1}. ${item.q} [정답: ${item.a.join('/')}]`;
        list.appendChild(li);
      });
      document.getElementById('start-btn').disabled = questions.length === 0;
    }

    function startQuiz() {
      document.getElementById('editor').style.display = 'none';
      const quizDiv = document.getElementById('quiz');
      const form = document.getElementById('quiz-form');
      form.innerHTML = '';
      questions.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'question';
        div.innerHTML = `
          <label>${idx+1}. ${item.q}</label><br>
          <input type="text" id="answer${idx}"><span id="feedback${idx}"></span>
        `;
        form.appendChild(div);
      });
      quizDiv.style.display = 'block';
    }

    function checkAnswers() {
      let score = 0;
      questions.forEach((item, idx) => {
        const user = document.getElementById(`answer${idx}`).value.trim();
        const fb = document.getElementById(`feedback${idx}`);
        const ok = item.a.some(ans => normalize(ans) === normalize(user));
        if (ok) {
          fb.textContent = ' 정답입니다!'; fb.className = 'correct'; score++;
        } else {
          fb.textContent = ` 오답. 정답: ${item.a[0]}`; fb.className = 'wrong';
        }
      });
      document.getElementById('result').innerHTML = `<h2>총 ${questions.length}문제 중 ${score}문제 정답 (${(score/questions.length*100).toFixed(1)}%)</h2>`;
    }

    function resetApp() {
      location.reload();
    }
  </script>
</body>
</html>
